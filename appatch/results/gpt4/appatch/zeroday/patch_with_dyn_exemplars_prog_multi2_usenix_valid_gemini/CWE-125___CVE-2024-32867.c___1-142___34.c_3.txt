diff
<             len += frag->data_len;
---
>             if (is_valid_fragment(frag)) { // Assuming is_valid_fragment() is a function that validates the fragment
>                 len += frag->data_len;
>             }
