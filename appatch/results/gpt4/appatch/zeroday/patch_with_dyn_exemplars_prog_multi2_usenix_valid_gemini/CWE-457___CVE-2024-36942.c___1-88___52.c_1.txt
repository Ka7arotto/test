c
51  if (ret)
52      goto out; // Use the existing 'out' label for cleanup

// ...

84 out:
85  vfree(data); // Free the allocated memory
86  return ret;
