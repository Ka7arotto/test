diff
< 			key_set_expiry(key, prep->expiry);
---
> 			time_t safe_expiry;
> 			if (__builtin_add_overflow(current_time(), prep->expiry, &safe_expiry)) {
> 				ret = -EOVERFLOW; // Or appropriate error code
> 			} else {
> 				key_set_expiry(key, safe_expiry);
> 			}
