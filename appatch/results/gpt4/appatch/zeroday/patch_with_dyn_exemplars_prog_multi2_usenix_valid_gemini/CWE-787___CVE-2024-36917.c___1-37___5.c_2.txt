diff
5     uint64_t start, len;
+    uint64_t device_size = get_device_size(bdev);
+
+    if (start >= device_size) {
+        return -EINVAL; // Or appropriate error code
+    }
+    if (start + len > device_size) {
+        len = device_size - start;
+    }
