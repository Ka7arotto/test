diff
<   cmd_buf = memdup_user(buffer, count + 1);
---
>   cmd_buf = kzalloc(count + 1, GFP_KERNEL);
>   if (!cmd_buf)
>       return -ENOMEM;
>   if (copy_from_user(cmd_buf, buffer, count))
>       return -EFAULT;
