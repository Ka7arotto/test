diff
1 static void event_interrupt_wq_v10(struct kfd_node *dev,
2 					const uint32_t *ih_ring_entry)
+3     size_t ih_ring_entry_size; // Assume this is passed or can be determined
4 	uint16_t source_id, client_id, pasid, vmid;
+5     if (!ih_ring_entry || ih_ring_entry_size < EXPECTED_SIZE) {
+6         // Handle error: invalid ih_ring_entry size
+7         return;
+8     }
8 	source_id = SOC15_SOURCE_ID_FROM_IH_ENTRY(ih_ring_entry);
