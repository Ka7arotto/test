diff
<     gsm->buf[gsm->count++] = c;
<     if (gsm->count == gsm->len)
---
>     if (gsm->count < gsm->mru) {
>         gsm->buf[gsm->count++] = c;
>     } else {
>         // Handle error: buffer overflow
>     }
>     if (gsm->count == gsm->len)
