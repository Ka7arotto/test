diff
<   cmd_buf = memdup_user(buffer, count + 1);
---
>   cmd_buf = strndup_user(buffer, count);
>   if (IS_ERR(cmd_buf))
>       return PTR_ERR(cmd_buf);
