diff
<     drv_buf_iter->kern_buf_len = (sizeof(*bsg_reply_buf) - 1 + ...);
---
>     size_t max_buf_size = ...; // Define the maximum buffer size based on the context
>     size_t calculated_len = (sizeof(*bsg_reply_buf) - 1 + ...);
>     if (calculated_len > max_buf_size) {
>         // Handle error due to buffer size overflow
>         return -EINVAL;
>     }
>     drv_buf_iter->kern_buf_len = calculated_len;
