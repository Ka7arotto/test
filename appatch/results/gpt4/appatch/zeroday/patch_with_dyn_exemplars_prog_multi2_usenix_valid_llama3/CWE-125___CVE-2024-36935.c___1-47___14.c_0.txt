diff
< 	cmd_buf = memdup_user(buf, count);
---
> 	if (!access_ok(buf, count))
> 		return -EFAULT;
> 	cmd_buf = memdup_user(buf, count);
