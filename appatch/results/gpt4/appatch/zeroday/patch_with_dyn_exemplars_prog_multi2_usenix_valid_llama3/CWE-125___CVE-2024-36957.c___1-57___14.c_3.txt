diff
<   cmd_buf = memdup_user(buffer, count + 1);
---
>   if (count > MAX_USER_BUFFER_SIZE)
>       return -EINVAL;
>   cmd_buf = memdup_user(buffer, count + 1);
