diff
<     drv_buf_iter->kern_buf_len = (sizeof(*bsg_reply_buf) - 1 + ...);
---
>     size_t new_buf_len = (sizeof(*bsg_reply_buf) - 1 + ...);
>     drv_buf_iter->kern_buf = kzalloc(new_buf_len, GFP_KERNEL);
>     if (!drv_buf_iter->kern_buf) {
>         // Handle error due to memory allocation failure
>         return -ENOMEM;
>     }
>     drv_buf_iter->kern_buf_len = new_buf_len;
