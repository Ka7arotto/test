diff
+ // Function to safely calculate time delta and prevent underflow
+ u64 safe_time_delta(u64 later, u64 earlier) {
+     if (later < earlier) {
+         // Handle underflow, possibly by returning a safe default or reporting an error
+         return DEFAULT_SAFE_DELTA;
+     }
+     return later - earlier;
+ }
+
+ // Use the safe_time_delta function for calculating tdelta
+ tdelta = safe_time_delta(later_timestamp, earlier_timestamp);
