diff
+ // Perform safe addition to prevent overflow in new_delay
+ if (MAX_U64_VALUE - delay < additional_value) {
+     // Handle overflow, possibly by setting new_delay to MAX_U64_VALUE or reporting an error
+     new_delay = MAX_U64_VALUE;
+ } else {
+     new_delay = delay + additional_value;
+ }
