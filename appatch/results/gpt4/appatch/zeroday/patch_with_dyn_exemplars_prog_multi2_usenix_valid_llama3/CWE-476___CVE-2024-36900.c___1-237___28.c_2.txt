diff
7  hdev = devm_kzalloc(&pdev->dev, sizeof(*hdev), GFP_KERNEL);
8  if (hdev) {
+    hdev->pdev = pdev;
+    hdev->ae_dev = ae_dev;
+    hdev->reset_type = HNAE3_NONE_RESET;
+    hdev->reset_level = HNAE3_FUNC_RESET;
+    hdev->mps = ETH_FRAME_LEN + ETH_FCS_LEN + 2 * VLAN_HLEN;
+    ret = hclge_pci_init(hdev);
+    if (ret)
+      return ret;
+    ret = hclge_devlink_init(hdev);
+    if (ret)
+      return ret;
+  } else {
+    return -ENOMEM;
+  }
