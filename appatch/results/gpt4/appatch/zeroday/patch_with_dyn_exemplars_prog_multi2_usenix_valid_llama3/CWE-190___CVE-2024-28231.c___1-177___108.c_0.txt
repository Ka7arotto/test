diff
107         uint32_t payload_size;
108 +       if (smh->submessageLength >= VALUE_BEING_SUBTRACTED)
109             payload_size = smh->submessageLength - VALUE_BEING_SUBTRACTED;
110 +       else
111 +           return HANDLE_ERROR; // Or appropriate error handling
