diff
<     entry = vm->pt_ops->pde_encode_bo(bo, map_ofs + (level - 1) * XE_PAGE_SIZE);
---
>     u32 safe_level = (UINT_MAX / XE_PAGE_SIZE) + 1;
>     if (level > safe_level) {
>         level = safe_level;
>     }
>     entry = vm->pt_ops->pde_encode_bo(bo, map_ofs + (level - 1) * XE_PAGE_SIZE);
