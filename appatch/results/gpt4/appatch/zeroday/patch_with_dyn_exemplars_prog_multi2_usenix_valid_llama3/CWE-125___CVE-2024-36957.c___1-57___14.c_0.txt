diff
<   cmd_buf = memdup_user(buffer, count + 1);
---
>   if (!access_ok(buffer, count))
>       return -EFAULT;
>   cmd_buf = memdup_user(buffer, count + 1);
