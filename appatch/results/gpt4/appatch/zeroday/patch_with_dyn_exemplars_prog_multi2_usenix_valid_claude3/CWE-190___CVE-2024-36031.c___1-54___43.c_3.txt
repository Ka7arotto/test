diff
< 			key_set_expiry(key, prep->expiry);
---
> 			time_t clamped_expiry = (prep->expiry > MAX_EXPIRY_VALUE) ? MAX_EXPIRY_VALUE : prep->expiry;
> 			key_set_expiry(key, clamped_expiry);
