diff
< 			key_set_expiry(key, prep->expiry);
---
> 			if (prep->expiry >= 0 && prep->expiry <= MAX_EXPIRY_VALUE) {
> 				key_set_expiry(key, prep->expiry);
> 			} else {
> 				ret = -EINVAL; // Or appropriate error code
> 			}
