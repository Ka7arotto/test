c
1 static __always_inline void maybe_wipe_obj_freeptr(struct kmem_cache *s,
2                                                    void *obj)
3 {
4     if (unlikely(slab_want_init_on_free(s)) && obj) {
5         schedule_wipe_obj(obj, s->offset); // Schedule the wipe for a later time
6         // The scheduled function should validate the object before wiping
7     }
8 }
