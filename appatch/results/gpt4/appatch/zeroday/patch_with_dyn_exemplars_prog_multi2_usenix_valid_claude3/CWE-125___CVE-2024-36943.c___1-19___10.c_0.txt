c
static void make_uffd_wp_pte(struct vm_area_struct *vma,
                             unsigned long addr, pte_t *pte) {
    if (!pte) {
        // Handle the error or return
        return;
    }
    pte_t ptent = ptep_get(pte);
    if (pte_present(ptent)) {
        ptent = pte_mkuffd_wp(ptent);
    }
    // Rest of the code...
}
