diff
<     buffer = vmemdup_user(buf, lbuf);
---
>     if (lbuf > MAX_USER_BUFFER_SIZE) {
>         return -EINVAL;
>     }
>     buffer = vmemdup_user(buf, lbuf);
