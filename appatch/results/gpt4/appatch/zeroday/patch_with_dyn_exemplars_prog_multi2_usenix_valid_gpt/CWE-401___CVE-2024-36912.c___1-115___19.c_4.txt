c
// Define a cleanup function that safely frees resources.
void cleanup_resources(struct vmbus_channel_msginfo *info) {
    if (info) {
        // Free any allocated resources within info.
        free_msginfo_resources(info);
        kfree(info);
    }
}

18 	ret = create_gpadl_header(type, kbuffer, size, send_offset, &msginfo);
19 	if (ret) {
20 		cleanup_resources(msginfo);
21 		return ret;
22 	}

// Use cleanup_resources in other error handling paths as well.
