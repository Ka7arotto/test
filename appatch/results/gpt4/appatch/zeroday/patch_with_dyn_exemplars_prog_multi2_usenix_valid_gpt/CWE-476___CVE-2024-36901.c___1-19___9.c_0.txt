c
struct inet6_dev *idev = ip6_dst_idev(skb_dst(skb));
if (idev == NULL) {
    // Handle the error, possibly by returning an error code or logging the issue
    return -EINVAL; // or appropriate error handling
}
if (unlikely(READ_ONCE(idev->cnf.disable_ipv6))) {
    // Existing logic
}
