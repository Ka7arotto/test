diff
// Hypothetical usage of build_label where the vulnerability might occur
-    size_t external_length = get_external_length();
-    memcpy(build_label, external_data, external_length);
+    size_t external_length = get_external_length();
+    if (external_length <= QCA_FW_BUILD_VER_LEN) {
+        memcpy(build_label, external_data, external_length);
+    }
