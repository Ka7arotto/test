diff
+ #define MAX_SRC_SIZE 4096 // Hypothetical maximum size for source data
  int zgfx_decompress(ZGFX_CONTEXT* zgfx, const BYTE* pSrcData, UINT32 SrcSize, BYTE** ppDstData,
+ if (SrcSize > MAX_SRC_SIZE) {
+     return ERROR_INVALID_DATA; // or an appropriate error code
+ }
  wStream sbuffer = { 0 };
