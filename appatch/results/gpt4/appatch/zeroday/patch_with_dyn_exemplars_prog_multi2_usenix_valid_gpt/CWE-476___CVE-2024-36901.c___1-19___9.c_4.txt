diff
4   struct inet6_dev *idev = ip6_dst_idev(skb_dst(skb));
---
4   struct inet6_dev *idev = ip6_dst_idev(skb_dst(skb));
5   if (!idev)
6       return 0; // Exit the function early if idev is NULL
