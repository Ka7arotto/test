diff
<     buffer = vmemdup_user(buf, lbuf);
---
>     if (!access_ok(VERIFY_READ, buf, lbuf)) {
>         return -EFAULT;
>     }
>     buffer = vmemdup_user(buf, lbuf);
