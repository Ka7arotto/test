diff
22     *outptr++ = colormap[0][t]; /* colormap[x] has size cmaplen */
---
22     if (t < 0 || t >= cmaplen) {
22         handleError("Index out of bounds");
22         return;
22     }
22     *outptr++ = colormap[0][t];
