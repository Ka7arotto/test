diff
6   int es = samplesperpixel - nc;
+  if (es < 0 || es > samplesperpixel) {
+      TIFFError(filename, "Invalid extra sample size");
+      _TIFFfree((char *) tf_buf);
+      return;
+  }
