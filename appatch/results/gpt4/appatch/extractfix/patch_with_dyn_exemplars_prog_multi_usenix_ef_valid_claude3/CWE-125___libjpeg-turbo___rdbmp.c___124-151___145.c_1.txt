diff
22     *outptr++ = colormap[0][t]; /* colormap[x] has size cmaplen */
---
22     if (t >= 0 && t < cmaplen) {
22         *outptr++ = colormap[0][t];
22     } else {
22         *outptr++ = default_color; // Handle out-of-bounds by using a default color
22     }
