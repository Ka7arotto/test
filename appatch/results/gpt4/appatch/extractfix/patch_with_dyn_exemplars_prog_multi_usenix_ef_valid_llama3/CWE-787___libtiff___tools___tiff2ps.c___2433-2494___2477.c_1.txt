diff
57   cp += es;
+  if (cp > tf_buf + tf_bytesperrow) {
+      TIFFError(filename, "Buffer overflow prevented");
+      break;
+  }
