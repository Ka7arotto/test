diff
876  WCHAR* str = Stream_PointerAs(s, WCHAR);
+877  if (str == NULL)
+878      return -1;
879  if (length == 0)
880      return 0;
