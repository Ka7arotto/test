diff
1896    skb->protocol = htons(ETH_P_NSH);
1897 -  __skb_push(skb, nsh_len);
1897 +  if (nsh_len <= skb->end - skb->data)
1898 +      __skb_push(skb, nsh_len);
1899 +  else
1900 +      return ERR_PTR(-EINVAL);
