diff
1896    skb->protocol = htons(ETH_P_NSH);
1897 -  __skb_push(skb, nsh_len);
1897 +  if (!skb_push_safe(skb, nsh_len))
1898 +      return ERR_PTR(-EINVAL);
