diff
876  WCHAR* str = Stream_PointerAs(s, WCHAR);
+877  if (!str)
+878  {
+879      fprintf(stderr, "Invalid stream pointer.\n");
+880      return -1;
+881  }
882  if (length == 0)
883      return 0;
