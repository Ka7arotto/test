c
// Assuming scsi_host_get and scsi_host_put manage reference counts
643  if (!scsi_host_get(shost))
644      return VPORT_INVAL;
...
651  scsi_remove_host(shost);
652  scsi_host_put(shost);  // Decrease reference count
...
654  if (scsi_host_get(shost)) {  // Ensure it's still valid
655      ndlp = lpfc_findnode_did(vport, Fabric_DID);
656      scsi_host_put(shost);
657  }
