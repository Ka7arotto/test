diff
-8   WINPR_ASSERT(str);
+8   if (str == NULL)
+9   {
+10      fprintf(stderr, "Assertion failed: Stream pointer is NULL.\n");
+11      return -1;
+12  }
