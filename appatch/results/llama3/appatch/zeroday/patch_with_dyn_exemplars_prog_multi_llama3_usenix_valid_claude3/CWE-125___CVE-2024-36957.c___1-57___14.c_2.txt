c
size_t alloc_size = count + 1;
if (alloc_size < count) {
    return -EINVAL;
}
cmd_buf = memdup_user(buffer, alloc_size);
if (!cmd_buf) {
    return -ENOMEM;
}
