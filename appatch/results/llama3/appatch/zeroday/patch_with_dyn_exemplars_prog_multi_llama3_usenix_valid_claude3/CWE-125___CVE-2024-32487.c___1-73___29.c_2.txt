c
< 	for (p = s;  p < s + slen;  p++)
---
> 	size_t len = strnlen(s, slen);
> 	for (p = s;  p < s + len;  p++)
