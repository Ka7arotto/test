c
< 		if (metachar(*p))
---
> 		if (metachar(*p) && p < s + slen - 1) {
> 			// ...
> 		}
