c
< 	gsm->state = GSM_DATA;
---
> 	if (gsm->len <= gsm->mru) {
> 		gsm->state = GSM_DATA;
> 	} else {
> 		// Handle error: out-of-bounds access
> 	}
