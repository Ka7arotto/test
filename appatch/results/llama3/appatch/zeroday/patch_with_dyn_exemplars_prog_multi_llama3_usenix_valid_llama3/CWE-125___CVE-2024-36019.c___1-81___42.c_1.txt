c
< 	upper = kmemdup(&entry[max + 1],
---
> 	size_t entry_size = sizeof(entry) / sizeof(entry[0]);
> 	if (max + 1 < entry_size) {
> 		upper = kmemdup(&entry[max + 1],
> 	} else {
> 		// Handle error: max is out of bounds
> 	}
