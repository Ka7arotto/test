c
< 	buffer = vmemdup_user(buf, lbuf);
---
> 	if (lbuf > MAX_ALLOWED_SIZE) {
> 		return -EINVAL;
> 	}
> 	buffer = vmemdup_user(buf, lbuf);
