
<         payload_size = smh->submessageLength -
---
>         if (smh->submessageLength > MAX_SUBMESSAGE_LENGTH) {
>             // handle error or invalid submessage length
>         }
>         payload_size = smh->submessageLength - ...;
