c
< 	kern_buf = memdup_user(buf, nbytes);
---
> 	if (nbytes > MAX_REASONABLE_SIZE) {
> 		return -EINVAL;
> 	}
> 	kern_buf = memdup_user(buf, nbytes);
