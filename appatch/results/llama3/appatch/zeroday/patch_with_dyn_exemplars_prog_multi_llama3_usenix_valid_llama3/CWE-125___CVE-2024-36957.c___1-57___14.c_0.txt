c
if (count > SIZE_MAX - 1) {
    return -EINVAL;
}
cmd_buf = memdup_user(buffer, count + 1);
if (!cmd_buf) {
    return -ENOMEM;
}
