c
< 	buffer = vmemdup_user(buf, lbuf);
---
> 	buffer = vmemdup_user(buf, lbuf);
> 	if (!buffer) {
> 		return -ENOMEM;
> 	}
