
< 	n_coalesce = kmemdup(&new_coalesce, sizeof(new_coalesce), GFP_KERNEL);
< 	if (!n_coalesce) {
---
> 	n_coalesce = kmemdup(&new_coalesce, sizeof(new_coalesce), GFP_KERNEL);
> 	if (!n_coalesce) {
> 		kfree(new_coalesce.rules);
> 		err = -ENOMEM;
> 		goto out;
> 	}
