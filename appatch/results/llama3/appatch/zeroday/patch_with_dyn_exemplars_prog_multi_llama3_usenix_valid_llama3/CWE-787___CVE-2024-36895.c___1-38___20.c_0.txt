
< 	unsigned int bufsize = 1 + size * 8 + 1 + 1;
< 	char *buf;
< 	buf = kzalloc(bufsize, GFP_KERNEL);
---
> 	unsigned int bufsize = 1 + size * 8 + 1 + 1;
> 	char *buf;
> 	buf = kzalloc(bufsize, GFP_KERNEL);
> 	unsigned int buf_size = bufsize; // store the actual size of the allocated memory
> 	while (i < buf_size && (pg - page < len) &&
