c
< 	upper = kmemdup(&entry[max + 1],
---
> 	upper = kmemdup_safe(&entry[max + 1],
> 		(entry_size - (max + 1)), GFP_KERNEL);
