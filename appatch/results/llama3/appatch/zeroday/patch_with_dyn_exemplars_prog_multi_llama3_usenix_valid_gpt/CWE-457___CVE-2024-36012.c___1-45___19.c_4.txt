c
if (hdev != NULL) {
    hci_dev_lock(hdev);
    if (hci_dev_valid(hdev) && !hci_dev_test_flag(hdev, HCI_UNREGISTER)) {
        msft_unregister(hdev);
    } else {
        BT_ERR("Invalid hdev pointer or already unregistered");
    }
    hci_dev_unlock(hdev);
}
