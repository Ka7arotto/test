c
<         for (; cc < tf_bytesperrow; cc += samplesperpixel) {
---
>         for (; cc < tf_bytesperrow; cc += samplesperpixel) {
>             if (cp + es > tf_buf + tf_bytesperrow) {
>                 // Handle error or exit loop
>             }
