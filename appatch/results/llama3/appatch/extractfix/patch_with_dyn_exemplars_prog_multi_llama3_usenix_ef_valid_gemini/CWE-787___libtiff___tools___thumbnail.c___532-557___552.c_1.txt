c
< 	rows[nrows++] = br + bpr*sy;
---
> 	if (nrows >= sizeof(rows) / sizeof(rows[0])) {
> 		break; // Exit loop
> 	}
> 	rows[nrows++] = br + bpr*sy;
