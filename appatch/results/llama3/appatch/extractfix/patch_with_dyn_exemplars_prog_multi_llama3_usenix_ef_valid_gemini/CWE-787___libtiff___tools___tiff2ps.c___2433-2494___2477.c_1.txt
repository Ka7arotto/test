c
<         int es = samplesperpixel - nc;
---
>         int es = samplesperpixel - nc;
>         if (es < 0) {
>             // Handle error or exit loop
>         }
