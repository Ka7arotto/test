diff
  hdev->ae_dev = ae_dev;
  hdev->reset_type = HNAE3_NONE_RESET;
  hdev->reset_level = HNAE3_FUNC_RESET;
  ae_dev->priv = hdev;
+ hdev->devlink = devlink_alloc(&hclge_devlink_ops, sizeof(struct hclge_dev));
+ if (!hdev->devlink) {
+     dev_err(&pdev->dev, "failed to allocate devlink\n");
+     return -ENOMEM;
+ }
