diff
- skb_put(n, skb->len);
+ if (skb_put_data(n, skb->data, skb->len) < 0) {
+     kfree_skb(n);
+     return NULL;
+ }
