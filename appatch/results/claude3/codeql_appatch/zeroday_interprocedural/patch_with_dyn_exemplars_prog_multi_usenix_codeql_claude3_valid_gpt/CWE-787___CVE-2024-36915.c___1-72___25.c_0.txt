
14 	lock_sock(sk);
15 	if (optlen < sizeof(u32)) {
16 		err = -EINVAL;
17 		goto out;
18 	}
...
25 		if (copy_from_sockptr(&opt, optval, sizeof(u32))) {
...
47 		if (copy_from_sockptr(&opt, optval, sizeof(u32))) {
...
out:
	release_sock(sk);
	return err;
