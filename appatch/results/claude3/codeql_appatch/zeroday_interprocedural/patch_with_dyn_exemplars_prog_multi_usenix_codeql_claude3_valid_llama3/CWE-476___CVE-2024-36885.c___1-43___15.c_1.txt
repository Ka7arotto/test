
< 		memcpy(fw->img, src, fw->len);
---
> 		if (fw->len <= len)
> 			memcpy(fw->img, src, fw->len);
> 		else
> 			return -EINVAL;
