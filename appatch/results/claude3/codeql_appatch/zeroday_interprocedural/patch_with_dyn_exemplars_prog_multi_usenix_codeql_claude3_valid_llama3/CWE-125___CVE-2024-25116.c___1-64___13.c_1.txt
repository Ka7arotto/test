diff
+ if (bucketSize > LLONG_MAX / 2) {
+     return RedisModule_ReplyWithError(ctx, "BUCKETSIZE is too large");
+ }
  if (bucketSize * 2 > capacity) {
