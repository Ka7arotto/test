
< SSIZE_T ConvertUtf8NToWChar(const char* str, size_t len, WCHAR* wstr, size_t wlen)
< {
< 	size_t ilen = strnlen(str, len);
< 	BOOL isNullTerminated = FALSE;
< 	if (len == 0)
< 		return 0;
< 
< 	WINPR_ASSERT(str);
---
> #define CHECK_NULL(ptr) if (!(ptr)) return -1
> 
> SSIZE_T ConvertUtf8NToWChar(const char* str, size_t len, WCHAR* wstr, size_t wlen)
> {
> 	CHECK_NULL(str);
> 	
> 	size_t ilen = strnlen(str, len);
> 	BOOL isNullTerminated = FALSE;
> 	if (len == 0)
> 		return 0;
