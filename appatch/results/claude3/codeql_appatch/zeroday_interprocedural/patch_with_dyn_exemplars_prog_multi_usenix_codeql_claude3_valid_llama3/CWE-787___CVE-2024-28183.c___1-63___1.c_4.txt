
< memcpy((void *)load_addr, data, data_len);
---
> if (load_addr == 0 || data_len == 0 || data_len > MAX_ALLOWED_SIZE) {
>     ESP_LOGE(TAG, "Invalid load_addr or data_len");
>     return ESP_FAIL;
> }
> memcpy((void *)load_addr, data, data_len);
