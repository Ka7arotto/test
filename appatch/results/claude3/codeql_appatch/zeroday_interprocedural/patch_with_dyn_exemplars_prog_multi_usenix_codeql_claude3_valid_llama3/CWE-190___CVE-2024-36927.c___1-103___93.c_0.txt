diff
void icmp_out_count(struct net *net, unsigned char type)
{
+    if (type < 256) {
         ICMPMSGOUT_INC_STATS(net, type);
+    } else {
+        pr_warn("Invalid ICMP type: %u\n", type);
+    }
     ICMP_INC_STATS(net, ICMP_MIB_OUTMSGS);
}
