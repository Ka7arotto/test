diff
- unsigned int bufsize = 1 + size * 8 + 1 + 1;
+ unsigned int bufsize;
+ if (size > (UINT_MAX - 3) / 8) {
+     return -EINVAL;
+ }
+ bufsize = 1 + size * 8 + 1 + 1;
