1 int av_hwframe_ctx_init(AVBufferRef *ref)
3     AVHWFramesContext *ctx = (AVHWFramesContext*)ref->data;
4     const enum AVPixelFormat *pix_fmt;
5     int ret;
7     if (ctx->internal->source_frames) {
9         return 0;
13     for (pix_fmt = ctx->internal->hw_type->pix_fmts; *pix_fmt != AV_PIX_FMT_NONE; pix_fmt++) {
14         if (*pix_fmt == ctx->format)
15             break;
17     if (*pix_fmt == AV_PIX_FMT_NONE) {
18         av_log(ctx, AV_LOG_ERROR,
19                "The hardware pixel format '%s' is not supported by the device type '%s'\n",
20                av_get_pix_fmt_name(ctx->format), ctx->internal->hw_type->name);