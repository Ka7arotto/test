1 static int xdp_do_generic_redirect_map(struct net_device *dev,
2 				       struct sk_buff *skb,
3 				       struct xdp_buff *xdp,
4 				       struct bpf_prog *xdp_prog,
5 				       void *fwd,
6 				       enum bpf_map_type map_type, u32 map_id)
8 	struct bpf_redirect_info *ri = this_cpu_ptr(&bpf_redirect_info);
9 	struct bpf_map *map;
10 	int err;
12 	switch (map_type) {
13 	case BPF_MAP_TYPE_DEVMAP:
14 		fallthrough;
15 	case BPF_MAP_TYPE_DEVMAP_HASH:
16 		map = READ_ONCE(ri->map);