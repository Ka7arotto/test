diff
- skb_put(n, skb->len);
+ if (skb_copy_bits(skb, 0, skb_put(n, skb->len), skb->len) < 0) {
+     kfree_skb(n);
+     return NULL;
+ }
