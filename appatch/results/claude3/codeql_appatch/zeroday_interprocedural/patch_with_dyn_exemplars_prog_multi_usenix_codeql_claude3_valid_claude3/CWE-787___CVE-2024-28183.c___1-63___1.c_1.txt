
< memcpy((void *)load_addr, data, data_len);
---
> if (memcpy_s((void *)load_addr, MAX_ALLOWED_SIZE, data, data_len) != 0) {
>     ESP_LOGE(TAG, "memcpy_s failed");
>     return ESP_FAIL;
> }
