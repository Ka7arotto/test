
< 	if (atomic_read(&card->qdio.state) != QETH_QDIO_UNINITIALIZED)
< 		qeth_free_qdio_queues(card);
< 
< 	if (max == 1 && card->qdio.do_prio_queueing != QETH_PRIOQ_DEFAULT)
< 		dev_info(&card->gdev->dev, "Priority Queueing not supported\n");
< 
< 	card->qdio.no_out_queues = max;
---
> 	bool need_free = (atomic_read(&card->qdio.state) != QETH_QDIO_UNINITIALIZED);
> 	bool prio_not_supported = (max == 1 && card->qdio.do_prio_queueing != QETH_PRIOQ_DEFAULT);
> 
> 	if (need_free)
> 		qeth_free_qdio_queues(card);
> 
> 	if (prio_not_supported)
> 		dev_info(&card->gdev->dev, "Priority Queueing not supported\n");
> 
> 	card->qdio.no_out_queues = max;
