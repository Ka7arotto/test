
static int check_and_copy(u32 *opt, sockptr_t optval, unsigned int optlen)
{
	if (optlen < sizeof(u32))
		return -EINVAL;
	return copy_from_sockptr(opt, optval, sizeof(u32));
}

...

25 		if (check_and_copy(&opt, optval, optlen)) {
...
47 		if (check_and_copy(&opt, optval, optlen)) {
