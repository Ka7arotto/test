diff
+ #include <string.h>
...
- memcpy(nexthop_mac, neigh->ha, ETH_ALEN);
+ if (memcpy_s(nexthop_mac, sizeof(nexthop_mac), neigh->ha, ETH_ALEN) != 0) {
+     // Handle error
+     return -EFAULT;
+ }
