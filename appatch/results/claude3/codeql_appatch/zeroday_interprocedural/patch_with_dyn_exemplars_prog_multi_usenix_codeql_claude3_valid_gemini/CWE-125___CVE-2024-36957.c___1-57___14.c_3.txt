diff
- subtoken = strsep(&cmd_buf, " ");
- ret = subtoken ? kstrtoint(subtoken, 10, &lf) : -EINVAL;
- if (cmd_buf)
-     ret = -EINVAL;
+ char *endptr;
+ long val = simple_strtol(cmd_buf, &endptr, 10);
+ if (endptr == cmd_buf || *endptr != '\0' || val < INT_MIN || val > INT_MAX) {
+     ret = -EINVAL;
+ } else {
+     lf = (int)val;
+     ret = 0;
+ }
