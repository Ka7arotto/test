
< memcpy((void *)load_addr, data, data_len);
---
> if (safe_memcpy((void *)load_addr, data, data_len, MAX_ALLOWED_SIZE) != ESP_OK) {
>     ESP_LOGE(TAG, "safe_memcpy failed");
>     return ESP_FAIL;
> }
