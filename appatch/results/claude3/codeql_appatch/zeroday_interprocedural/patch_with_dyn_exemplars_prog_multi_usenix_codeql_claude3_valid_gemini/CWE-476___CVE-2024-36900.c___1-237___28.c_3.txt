diff
+ static int safe_devl_lock(struct hclge_dev *hdev)
+ {
+     if (!hdev || !hdev->devlink) {
+         pr_err("Invalid hdev or devlink\n");
+         return -EINVAL;
+     }
+     devl_lock(hdev->devlink);
+     return 0;
+ }

- devl_lock(hdev->devlink);
+ ret = safe_devl_lock(hdev);
+ if (ret)
+     goto err_devlink_uninit;
