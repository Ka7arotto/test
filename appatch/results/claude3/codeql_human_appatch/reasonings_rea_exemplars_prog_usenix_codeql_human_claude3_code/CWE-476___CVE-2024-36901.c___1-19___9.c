1 int ip6_output(struct net *net, struct sock *sk, struct sk_buff *skb)
3 	struct net_device *dev = skb_dst(skb)->dev, *indev = skb->dev;
4 	struct inet6_dev *idev = ip6_dst_idev(skb_dst(skb));
6 	skb->protocol = htons(ETH_P_IPV6);
7 	skb->dev = dev;
9 	if (unlikely(READ_ONCE(idev->cnf.disable_ipv6))) {
10 		IP6_INC_STATS(net, idev, IPSTATS_MIB_OUTDISCARDS);
11 		kfree_skb(skb);