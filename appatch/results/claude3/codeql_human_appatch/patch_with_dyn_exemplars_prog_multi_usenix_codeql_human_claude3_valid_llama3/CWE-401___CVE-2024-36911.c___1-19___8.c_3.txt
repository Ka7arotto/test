diff
+	static inline void safe_vfree_and_null(void **ptr) {
+		if (*ptr) {
+			vfree(*ptr);
+			*ptr = NULL;
+		}
+	}
 	
-	vfree(nvdev->recv_buf);
+	safe_vfree_and_null(&nvdev->recv_buf);
