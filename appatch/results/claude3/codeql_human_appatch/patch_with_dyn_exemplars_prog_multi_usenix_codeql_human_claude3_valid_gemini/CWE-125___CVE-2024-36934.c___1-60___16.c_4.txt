
< kern_buf = memdup_user(buf, nbytes);
---
+ if (nbytes == 0 || nbytes > PAGE_SIZE) {
+     netdev_warn(bnad->netdev, "Invalid input size\n");
+     return -EINVAL;
+ }
+ kern_buf = memdup_user(buf, nbytes);
