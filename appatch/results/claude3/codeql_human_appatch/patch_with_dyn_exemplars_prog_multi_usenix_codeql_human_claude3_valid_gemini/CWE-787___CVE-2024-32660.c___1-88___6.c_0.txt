diff
+ #define MAX_SRC_SIZE 1048576 // 1 MB limit, adjust as needed
- wStream* stream = Stream_StaticConstInit(&sbuffer, pSrcData, SrcSize);
+ if (SrcSize > MAX_SRC_SIZE) {
+     WLog_ERR(TAG, "SrcSize exceeds maximum allowed size");
+     goto fail;
+ }
+ wStream* stream = Stream_StaticConstInit(&sbuffer, pSrcData, SrcSize);
