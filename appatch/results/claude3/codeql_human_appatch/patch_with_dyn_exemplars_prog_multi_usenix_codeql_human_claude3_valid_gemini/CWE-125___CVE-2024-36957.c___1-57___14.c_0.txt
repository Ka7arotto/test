
<   cmd_buf = memdup_user(buffer, count + 1);
---
>   cmd_buf = memdup_user(buffer, count);
>   if (!IS_ERR(cmd_buf)) {
>       cmd_buf = krealloc(cmd_buf, count + 1, GFP_KERNEL);
>       if (cmd_buf)
>           cmd_buf[count] = '\0';
>       else
>           return -ENOMEM;
>   }
