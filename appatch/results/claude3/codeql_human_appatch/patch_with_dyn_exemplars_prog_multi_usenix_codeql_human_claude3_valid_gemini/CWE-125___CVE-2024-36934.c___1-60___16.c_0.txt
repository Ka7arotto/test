
+ #define MAX_INPUT_SIZE 1024  // Define a reasonable maximum size
< kern_buf = memdup_user(buf, nbytes);
---
+ if (nbytes > MAX_INPUT_SIZE)
+     return -EINVAL;
+ kern_buf = memdup_user(buf, nbytes);
