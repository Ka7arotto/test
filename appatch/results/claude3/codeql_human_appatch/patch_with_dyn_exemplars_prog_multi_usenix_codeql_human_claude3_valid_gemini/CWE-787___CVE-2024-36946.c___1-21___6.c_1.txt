c
#define MAX_SKB_SIZE 4096
size_t size = NLMSG_ALIGN(sizeof(struct ifaddrmsg)) +
              nla_total_size(1) + nla_total_size(4);
if (size > MAX_SKB_SIZE)
    goto errout;
skb = nlmsg_new(size, GFP_KERNEL);
