
< 		memcpy(nexthop_mac, neigh->ha, ETH_ALEN);
---
> 		if (neigh->ha != NULL) {
> 			memcpy(nexthop_mac, neigh->ha, ETH_ALEN);
> 		} else {
> 			pr_warn("neigh->ha is NULL, using default MAC\n");
> 			memcpy(nexthop_mac, (unsigned char[ETH_ALEN]){0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF}, ETH_ALEN);
> 		}
