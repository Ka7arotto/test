
<            key_set_expiry(key, prep->expiry);
---
>            unsigned long safe_expiry = (prep->expiry > ULONG_MAX - EXPIRY_OFFSET) ? 
>                                        ULONG_MAX : prep->expiry + EXPIRY_OFFSET;
>            key_set_expiry(key, safe_expiry);
