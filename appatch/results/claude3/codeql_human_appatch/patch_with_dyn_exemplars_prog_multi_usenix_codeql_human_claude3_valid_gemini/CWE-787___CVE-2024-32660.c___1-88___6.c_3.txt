diff
+ static wStream* SafeStreamInit(wStream* sbuffer, const BYTE* data, UINT32 size) {
+     if (!data || size == 0 || size > MAX_SAFE_SIZE) {
+         WLog_ERR(TAG, "Invalid stream parameters");
+         return NULL;
+     }
+     return Stream_StaticConstInit(sbuffer, data, size);
+ }

- wStream* stream = Stream_StaticConstInit(&sbuffer, pSrcData, SrcSize);
+ wStream* stream = SafeStreamInit(&sbuffer, pSrcData, SrcSize);
+ if (!stream) {
+     goto fail;
+ }
