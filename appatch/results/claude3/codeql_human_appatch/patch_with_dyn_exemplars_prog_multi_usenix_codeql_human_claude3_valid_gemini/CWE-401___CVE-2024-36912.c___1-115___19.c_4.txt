
do {
    ret = create_gpadl_header(type, kbuffer, size, send_offset, &msginfo);
    if (ret)
        break;

    // Rest of the function...

} while (0);

if (ret)
    kfree(msginfo);

return ret;
