
+ static BOOL ValidateParams(const BYTE* pbOrderHdr, const BYTE* pbEnd)
+ {
+    return (pbOrderHdr && pbEnd && pbOrderHdr < pbEnd);
+ }

WINPR_ASSERT(advance);
+ if (!ValidateParams(pbOrderHdr, pbEnd))
+    return 0;  // or appropriate error code
