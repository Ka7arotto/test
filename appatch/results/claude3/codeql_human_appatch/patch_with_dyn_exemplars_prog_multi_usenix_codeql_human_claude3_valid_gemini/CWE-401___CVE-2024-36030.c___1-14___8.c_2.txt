diff
+static inline void safe_free(void **ptr) {
+    if (ptr && *ptr) {
+        kfree(*ptr);
+        *ptr = NULL;
+    }
+}

-	kfree(mcam->counters.bmap);
+	safe_free((void **)&mcam->counters.bmap);
