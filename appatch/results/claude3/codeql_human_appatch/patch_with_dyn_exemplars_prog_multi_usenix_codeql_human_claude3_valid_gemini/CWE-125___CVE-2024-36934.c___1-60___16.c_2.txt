
+ #define MAX_INPUT_SIZE sizeof(struct bnad_debug_info)
< kern_buf = memdup_user(buf, nbytes);
---
+ if (nbytes > MAX_INPUT_SIZE) {
+     netdev_warn(bnad->netdev, "Input size exceeds maximum allowed\n");
+     return -EINVAL;
+ }
+ kern_buf = memdup_user(buf, nbytes);
