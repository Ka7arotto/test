
< 	size_t ilen = strnlen(str, len);
< 	BOOL isNullTerminated = FALSE;
< 	if (len == 0)
< 		return 0;
< 
< 	WINPR_ASSERT(str);
---
> 	if (!str)
> 		return -1;  // or another appropriate error code
> 
> 	size_t ilen = str ? strnlen(str, len) : 0;
> 	BOOL isNullTerminated = FALSE;
> 	if (len == 0)
> 		return 0;
