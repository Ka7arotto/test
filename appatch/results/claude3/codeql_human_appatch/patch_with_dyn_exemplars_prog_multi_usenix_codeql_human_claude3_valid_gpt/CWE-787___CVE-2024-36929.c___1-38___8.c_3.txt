diff
- skb_put(n, skb->len);
+ if (skb_copy_bits(skb, 0, skb_put(n, min_t(unsigned int, skb->len, skb_tailroom(n))), min_t(unsigned int, skb->len, skb_tailroom(n))) < 0) {
+     kfree_skb(n);
+     return NULL;
+ }
