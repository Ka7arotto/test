
< 			upper = kmemdup(&entry[max + 1],
< 					((mas.last - max) *
< 					 sizeof(unsigned long)),
---
> 			size_t copy_size = (mas.last > max) ? (mas.last - max) : 0;
> 			upper = kmemdup(&entry[max + 1],
> 					(copy_size * sizeof(unsigned long)),
