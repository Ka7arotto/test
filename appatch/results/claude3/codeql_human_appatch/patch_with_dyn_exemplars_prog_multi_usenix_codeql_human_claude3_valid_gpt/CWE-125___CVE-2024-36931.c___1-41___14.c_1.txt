
< 	buffer = vmemdup_user(buf, lbuf);
---
> 	char fixed_buffer[256];
> 	if (strncpy_from_user(fixed_buffer, buf, sizeof(fixed_buffer)) < 0)
> 		return -EFAULT;
> 	buffer = fixed_buffer;
