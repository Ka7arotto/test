diff
+#define CHECK_NULL(ptr) do { if (!(ptr)) return; } while (0)

 void hub_get(struct usb_hub *hub)
 {
+    CHECK_NULL(hub);
     kref_get(&hub->kref);
 }
