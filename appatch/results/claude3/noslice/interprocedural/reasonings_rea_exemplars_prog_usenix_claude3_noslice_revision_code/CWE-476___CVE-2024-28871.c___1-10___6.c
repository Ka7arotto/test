1 void drm_client_register(struct drm_client_dev *client)
2 {
3         struct drm_device *dev = client->dev;
4         int ret;
5 
6         mutex_lock(&dev->clientlist_mutex);
7         list_add(&client->list, &dev->clientlist);
8 
9         if (client->funcs && client->funcs->hotplug) {
10                 ret = client->funcs->hotplug(client);
11                 if (ret)
12                         drm_dbg_kms(dev, "client hotplug ret=%d\n", ret);
13         }
14         mutex_unlock(&dev->clientlist_mutex);
15 }


int amdgpu_amdkfd_drm_client_create(struct amdgpu_device *adev)
{
	int ret;

	if (!adev->kfd.init_complete)
		return 0;

	ret = drm_client_init(&adev->ddev, &adev->kfd.client, "kfd",
			      &kfd_client_funcs);
	if (ret) {
		dev_err(adev->dev, "Failed to init DRM client: %d\n",
			ret);
		return ret;
	}

	drm_client_register(&adev->kfd.client);

	return 0;
}
