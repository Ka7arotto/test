c
int spi_sync(struct spi_device *spi, struct spi_message *message)
{
    return __spi_sync(spi, message);
}

static int __spi_sync(struct spi_device *spi, struct spi_message *message)
{
    int ret;
    mutex_lock(&spi->controller->bus_lock_mutex);
    // Perform sync operations
    mutex_unlock(&spi->controller->bus_lock_mutex);
    return ret;
}
