
< 	      if (row > nused)
< 		{
< 		  warn (_("Row index (%u) is larger than number of used entries (%u)\n"),
< 			row, nused);
< 		  return 0;
< 		}
< 	      if (!do_display)
< 		memcpy (&this_set[row - 1].signature, ph, sizeof (uint64_t));
---
> 	      if (row == 0 || row > nused)
> 		{
> 		  warn (_("Row index (%u) is invalid (must be > 0 and <= %u)\n"),
> 			row, nused);
> 		  return 0;
> 		}
> 	      if (!do_display)
> 		memcpy (&this_set[row - 1].signature, ph, sizeof (uint64_t));
