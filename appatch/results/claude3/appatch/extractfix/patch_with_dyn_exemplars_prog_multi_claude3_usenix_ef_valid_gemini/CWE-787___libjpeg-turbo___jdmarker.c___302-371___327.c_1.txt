
<   for (i = 0; i < cinfo->num_components; i++)
<       cinfo->cur_comp_info[i] = NULL; // cinfo->cur_comp_info has length MAX_COMPS_IN_SCAN
---
>   for (i = 0; i < cinfo->num_components && i < MAX_COMPS_IN_SCAN; i++)
>       cinfo->cur_comp_info[i] = NULL; // cinfo->cur_comp_info has length MAX_COMPS_IN_SCAN
