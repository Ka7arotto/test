
<     if (frame_end - frame < width + 3)
---
>     if (frame_end - frame < width + 4) {
>         // Implement circular buffer logic
>         memmove(frame_start, frame, frame_end - frame);
>         frame = frame_start + (frame_end - frame);
>     }
