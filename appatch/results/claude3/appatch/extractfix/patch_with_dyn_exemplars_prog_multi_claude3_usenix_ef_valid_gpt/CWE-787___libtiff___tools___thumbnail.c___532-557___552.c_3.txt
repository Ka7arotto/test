
< 		rows[nrows++] = br + bpr*sy;
---
> 		if (nrows < FIXED_BUFFER_SIZE) {
> 			rows[nrows++] = br + bpr*sy;
> 		} else {
> 			// Log error: buffer overflow prevented
> 			fprintf(stderr, "Error: Buffer overflow prevented at row %d\n", nrows);
> 			break;
> 		}
