
< 	n_coalesce = kmemdup(&new_coalesce, sizeof(new_coalesce), GFP_KERNEL);
< 	if (!n_coalesce) {
---
> 	n_coalesce = kmemdup(&new_coalesce, sizeof(new_coalesce), GFP_KERNEL);
> 	if (!n_coalesce) {
> 		err = -ENOMEM;
> 		goto out;
> 	}
> 	/* ... rest of the function ... */
> out:
> 	kfree(new_coalesce.rules);
> 	return err;
