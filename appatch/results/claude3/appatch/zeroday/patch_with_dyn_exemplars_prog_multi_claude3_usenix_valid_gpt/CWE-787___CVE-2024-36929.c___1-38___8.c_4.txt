
< struct sk_buff *n = __alloc_skb(newheadroom + skb->len + newtailroom,
---
> if (newheadroom > SIZE_MAX / 2 || newtailroom > SIZE_MAX / 2 || skb->len > SIZE_MAX / 2)
>     return NULL;
> size_t new_size = newheadroom + skb->len + newtailroom;
> struct sk_buff *n = __alloc_skb(new_size,
