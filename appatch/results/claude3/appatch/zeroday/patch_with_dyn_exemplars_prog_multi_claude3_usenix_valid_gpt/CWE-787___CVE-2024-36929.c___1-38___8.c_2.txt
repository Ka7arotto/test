
< struct sk_buff *n = __alloc_skb(newheadroom + skb->len + newtailroom,
---
> size_t new_size = newheadroom;
> if (new_size > SIZE_MAX - skb->len || (new_size += skb->len) > SIZE_MAX - newtailroom)
>     return NULL;
> new_size += newtailroom;
> struct sk_buff *n = __alloc_skb(new_size,
