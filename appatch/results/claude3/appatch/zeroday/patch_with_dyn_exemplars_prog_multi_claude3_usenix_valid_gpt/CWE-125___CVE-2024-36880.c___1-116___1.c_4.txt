c
static bool safe_read_tlv_data(struct hci_dev *hdev, void *dest, size_t offset, size_t length)
{
    if (offset + length > get_tlv_data_size(hdev)) {
        return false;
    }
    memcpy(dest, hdev->tlv_data + offset, length);
    return true;
}

static void qca_tlv_check_data(struct hci_dev *hdev)
{
    uint8_t buffer[MAX_TLV_SIZE];
    if (safe_read_tlv_data(hdev, buffer, 0, sizeof(buffer))) {
        // Process buffer safely
    }
}
