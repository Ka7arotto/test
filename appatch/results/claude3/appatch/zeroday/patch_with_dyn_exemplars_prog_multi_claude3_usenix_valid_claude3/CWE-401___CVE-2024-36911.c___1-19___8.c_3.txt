diff
+ #define SAFE_VFREE(ptr) do { vfree(ptr); ptr = NULL; } while (0)

// In the main function:
- 	vfree(nvdev->recv_buf);
+ 	SAFE_VFREE(nvdev->recv_buf);
