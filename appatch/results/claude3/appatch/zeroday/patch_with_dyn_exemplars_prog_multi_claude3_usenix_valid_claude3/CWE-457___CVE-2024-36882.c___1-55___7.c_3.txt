c
#include <linux/atomic.h>

// Assuming size and async_size are atomic_t types in struct file_ra_state
pgoff_t mark = index + atomic_read(&ra->size) - atomic_read(&ra->async_size);
