
<			key_set_expiry(key, prep->expiry);
---
>			if (prep->expiry > 0 && prep->expiry < LONG_MAX) {
>				key_set_expiry(key, prep->expiry);
>			} else {
>				ret = -EINVAL;
>				goto error_handle;
>			}
