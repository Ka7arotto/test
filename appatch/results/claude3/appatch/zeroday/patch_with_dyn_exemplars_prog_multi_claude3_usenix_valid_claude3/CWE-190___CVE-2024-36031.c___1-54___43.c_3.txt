
<			key_set_expiry(key, prep->expiry);
---
>			unsigned long long safe_expiry = (unsigned long long)prep->expiry;
>			key_set_expiry(key, (safe_expiry > LONG_MAX) ? LONG_MAX : (time_t)safe_expiry);
