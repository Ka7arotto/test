diff
< 		if (copy_from_sockptr(&opt, optval, sizeof(u32))) {
---
> 		if (optlen != sizeof(u32))
> 			return -EINVAL;
> 		if (copy_from_sockptr(&opt, optval, optlen)) {
