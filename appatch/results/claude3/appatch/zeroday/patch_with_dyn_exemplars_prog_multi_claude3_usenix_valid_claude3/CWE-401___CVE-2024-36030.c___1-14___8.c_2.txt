diff
+ static inline void safe_free_and_null(void **ptr) {
+ 	if (ptr && *ptr) {
+ 		kfree(*ptr);
+ 		*ptr = NULL;
+ 	}
+ }

// In the original function:
- 	kfree(mcam->counters.bmap);
+ 	safe_free_and_null((void **)&mcam->counters.bmap);
