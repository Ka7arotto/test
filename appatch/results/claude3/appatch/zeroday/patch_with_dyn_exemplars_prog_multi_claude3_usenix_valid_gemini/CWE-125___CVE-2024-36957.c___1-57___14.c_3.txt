
< 	cmd_buf = memdup_user(buffer, count + 1);
---
> 	#define MAX_CMD_SIZE 4096
> 	if (count > MAX_CMD_SIZE)
> 		return -EINVAL;
> 	cmd_buf = memdup_user(buffer, count + 1);
