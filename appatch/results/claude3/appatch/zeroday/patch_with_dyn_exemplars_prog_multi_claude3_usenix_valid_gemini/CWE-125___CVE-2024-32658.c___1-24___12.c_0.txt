
< 	runLength = (*pbOrderHdr) & g_MaskRegularRunLength;
< 	if (runLength == 0)
< 		if (!buffer_within_range(pbOrderHdr, 1, pbEnd))
---
> 	if (!buffer_within_range(pbOrderHdr, 1, pbEnd))
> 		return 0;  // or appropriate error handling
> 	runLength = (*pbOrderHdr) & g_MaskRegularRunLength;
> 	if (runLength == 0)
