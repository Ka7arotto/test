
< len += frag->data_len;
---
> if (len + frag->data_len > MAX_PACKET_SIZE) {
>     // Handle error: packet too large
>     return NULL;
> }
> len += frag->data_len;
