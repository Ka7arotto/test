
< 	cmd_buf = memdup_user(buffer, count + 1);
---
> 	cmd_buf = kstrndup_user(buffer, count, GFP_KERNEL);
> 	if (IS_ERR(cmd_buf))
> 		return PTR_ERR(cmd_buf);
