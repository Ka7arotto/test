patch
@@ -49,8 +49,10 @@ static int qca_download_firmware(struct hci_dev *hdev,
 
 	ret = qca_tlv_check_data(hdev, config, data, size, soc_type);
 	if (ret) {
+		vfree(data);
 		return ret;
 	}
+
 	segment = data;
 	remain = size;
