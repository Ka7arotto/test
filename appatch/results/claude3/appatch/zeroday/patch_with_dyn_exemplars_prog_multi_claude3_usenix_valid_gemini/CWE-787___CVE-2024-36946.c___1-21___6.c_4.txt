
< 	skb = nlmsg_new(NLMSG_ALIGN(sizeof(struct ifaddrmsg)) +
---
> 	size_t msg_size = NLMSG_ALIGN(sizeof(struct ifaddrmsg)) + nla_total_size(sizeof(u8));
> 	if (msg_size < sizeof(struct ifaddrmsg)) {
> 		return;  // Size calculation overflow
> 	}
> 	skb = nlmsg_new(msg_size, GFP_KERNEL);
