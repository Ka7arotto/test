
<     struct inet6_dev *idev = ip6_dst_idev(skb_dst(skb));
< 	if (unlikely(READ_ONCE(idev->cnf.disable_ipv6))) {
---
>     struct dst_entry *dst = skb_dst(skb);
>     if (!dst) {
>         return -EINVAL;
>     }
>     struct inet6_dev *idev = ip6_dst_idev(dst);
>     if (!idev) {
>         return -EINVAL;
>     }
> 	if (unlikely(READ_ONCE(idev->cnf.disable_ipv6))) {
