
< 	char user_val[16], *cmd_buf;
< 	cmd_buf = memdup_user(buf, count);
---
> 	char user_val[16], cmd_buf[9];
> 	if (copy_from_user(cmd_buf, buf, min_t(size_t, count, 8)))
> 		return -EFAULT;
> 	cmd_buf[8] = '\0';
