diff
+ static void safe_vfree(void **ptr) {
+ 	if (*ptr) {
+ 		vfree(*ptr);
+ 		*ptr = NULL;
+ 	}
+ }

// In the main function:
- 	vfree(nvdev->recv_buf);
+ 	safe_vfree((void **)&nvdev->recv_buf);
