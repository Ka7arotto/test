
< 		entry = vm->pt_ops->pde_encode_bo(bo, map_ofs + (level - 1) *
---
> 		#define MAX_SAFE_OFFSET ((UINT64_MAX - map_ofs) / ...)
> 		if (level - 1 > MAX_SAFE_OFFSET) {
> 			/* Handle overflow error */
> 			return -EOVERFLOW;
> 		}
> 		entry = vm->pt_ops->pde_encode_bo(bo, map_ofs + (level - 1) *
