
< uint32_t payload_size;
< payload_size = smh->submessageLength -
---
> uint32_t payload_size;
> const uint32_t MAX_ALLOWED_LENGTH = /* some appropriate maximum value */;
> if (smh->submessageLength > MAX_ALLOWED_LENGTH) {
>     // Handle error condition
>     return false;
> }
> payload_size = smh->submessageLength - /* other value */;
