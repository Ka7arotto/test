
< 		entry = vm->pt_ops->pde_encode_bo(bo, map_ofs + (level - 1) *
---
> 		uint64_t safe_add(uint64_t a, uint64_t b) {
> 			if (a > UINT64_MAX - b) return UINT64_MAX;
> 			return a + b;
> 		}
> 		entry = vm->pt_ops->pde_encode_bo(bo, safe_add(map_ofs, (level - 1) *
