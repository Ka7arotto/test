
< #define IS_VALID_OFFSET(offset, max) ((offset) < (max))
< 
<     if ((mpirep_offset != 0xFF) &&
<         drv_buf_iter = &drv_bufs[mpirep_offset];
<         drv_buf_iter->kern_buf_len = (sizeof(*bsg_reply_buf) - 1 +
---
> #define IS_VALID_OFFSET(offset, max) ((offset) < (max))
> 
>     if ((mpirep_offset != 0xFF) && IS_VALID_OFFSET(mpirep_offset, bufcnt)) {
>         drv_buf_iter = &drv_bufs[mpirep_offset];
>         drv_buf_iter->kern_buf_len = (sizeof(*bsg_reply_buf) - 1 +
