
< 	runLength = (*pbOrderHdr) & g_MaskRegularRunLength;
< 	if (runLength == 0)
< 		if (!buffer_within_range(pbOrderHdr, 1, pbEnd))
---
> 	if (!buffer_within_range(pbOrderHdr, 1, pbEnd) || ((*pbOrderHdr & g_MaskRegularRunLength) == 0))
