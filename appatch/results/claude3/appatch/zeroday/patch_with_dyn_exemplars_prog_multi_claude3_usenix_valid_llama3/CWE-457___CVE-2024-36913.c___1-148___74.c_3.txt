c
static int decrypt_monitor_pages(void)
{
    int ret = 0;
    if (vmbus_connection.monitor_pages[0] && vmbus_connection.monitor_pages[1]) {
        ret = set_memory_decrypted((unsigned long)
                    vmbus_connection.monitor_pages[0], 1);
        if (!ret) {
            ret = set_memory_decrypted((unsigned long)
                        vmbus_connection.monitor_pages[1], 1);
        }
    } else {
        ret = -ENOMEM;
    }
    return ret;
}

// In the main function:
71 ret = decrypt_monitor_pages();
72 if (ret) {
73     pr_err("Failed to set memory as decrypted\n");
74     goto cleanup;
75 }
