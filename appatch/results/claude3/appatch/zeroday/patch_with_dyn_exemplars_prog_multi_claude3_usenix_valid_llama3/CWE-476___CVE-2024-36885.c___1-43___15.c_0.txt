
<     fw->img = kmemdup(src, fw->len, GFP_KERNEL);
<     len = ALIGN(fw->len, PAGE_SIZE);
---
>     fw->img = kmemdup(src, fw->len, GFP_KERNEL);
>     if (!fw->img)
>         return -ENOMEM;
>     len = ALIGN(fw->len, PAGE_SIZE);
