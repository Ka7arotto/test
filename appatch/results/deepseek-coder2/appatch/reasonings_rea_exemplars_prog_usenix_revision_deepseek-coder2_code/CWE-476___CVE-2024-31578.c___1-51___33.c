1 int av_hwframe_ctx_init(AVBufferRef *ref)
3     AVHWFramesContext *ctx = (AVHWFramesContext*)ref->data;
4     const enum AVPixelFormat *pix_fmt;
5     int ret;
7     if (ctx->internal->source_frames) {
13     for (pix_fmt = ctx->internal->hw_type->pix_fmts; *pix_fmt != AV_PIX_FMT_NONE; pix_fmt++) {
14         if (*pix_fmt == ctx->format)
17     if (*pix_fmt == AV_PIX_FMT_NONE) {
25     ret = av_image_check_size(ctx->width, ctx->height, 0, ctx);
26     if (ret < 0)
30     if (ctx->internal->hw_type->frames_init) {
31         ret = ctx->internal->hw_type->frames_init(ctx);
32         if (ret < 0)
33             goto fail;