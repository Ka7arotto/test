1 static int qca_download_firmware(struct hci_dev *hdev,
2 				 struct qca_fw_config *config,
3 				 enum qca_btsoc_type soc_type,
4 				 u8 rom_ver)
6 	const struct firmware *fw;
7 	u8 *data;
13 	ret = request_firmware(&fw, config->fwname, &hdev->dev);
14 	if (ret) {
18 		if (soc_type == QCA_WCN6750 && config->type == ELF_TYPE_PATCH) {
21 			config->type = TLV_TYPE_PATCH;
22 			snprintf(config->fwname, sizeof(config->fwname),
25 			ret = request_firmware(&fw, config->fwname, &hdev->dev);
26 			if (ret) {
38 	size = fw->size;
39 	data = vmalloc(fw->size);
40 	if (!data) {
47 	memcpy(data, fw->data, size);
50 	ret = qca_tlv_check_data(hdev, config, data, size, soc_type);
51 	if (ret)
52 		return ret;