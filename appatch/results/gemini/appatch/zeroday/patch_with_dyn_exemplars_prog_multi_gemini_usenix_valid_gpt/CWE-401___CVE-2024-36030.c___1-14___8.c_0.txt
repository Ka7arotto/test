c
1 void rvu_npc_freemem(struct rvu *rvu)
2 {
3 	struct npc_pkind *pkind = &rvu->hw->pkind;
4 	struct npc_mcam *mcam = &rvu->hw->mcam;
5 
6 	kfree(pkind->rsrc.bmap);
7 	npc_mcam_rsrcs_deinit(rvu);
8 	kfree(mcam->counters.bmap);
9 	mcam->counters.bmap = NULL; //Patch 1. Invalidate the pointer
10 	if (rvu->kpu_prfl_addr)
11 		iounmap(rvu->kpu_prfl_addr);
12 	else
13 		kfree(rvu->kpu_fwdata);
14 	mutex_destroy(&mcam->lock);
15 }
