diff
--- a/drivers/net/ethernet/broadcom/bnx2x/bnad/bnad_debugfs.c
+++ b/drivers/net/ethernet/broadcom/bnx2x/bnad/bnad_debugfs.c
@@ -13,5 +13,5 @@
 	size_t cnt;
 	void *kern_buf;
 
-	kern_buf = memdup_user(buf, nbytes);
+	kern_buf = kmalloc_copy_from_user(buf, nbytes, GFP_KERNEL);
 	if (IS_ERR(kern_buf))

