diff
--- a/your_file.c
+++ b/your_file.c
@@ -18,7 +18,9 @@
 
 	ret = create_gpadl_header(type, kbuffer, size, send_offset, &msginfo);
 	if (ret)
+	{
+		kfree(msginfo);
 		return ret;
+	}
 
 	ret = set_memory_decrypted((unsigned long)kbuffer,
 				   PFN_UP(size));

