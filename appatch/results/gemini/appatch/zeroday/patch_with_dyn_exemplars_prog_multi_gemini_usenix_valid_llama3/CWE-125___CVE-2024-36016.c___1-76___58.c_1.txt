

* **Explanation:** This patch adds a bounds check directly before accessing `gsm->buf`.  It ensures that `gsm->count` is within the valid range of indices for the buffer.

**Patch 2:  Bounds Check Within the Data Handling Loop**

