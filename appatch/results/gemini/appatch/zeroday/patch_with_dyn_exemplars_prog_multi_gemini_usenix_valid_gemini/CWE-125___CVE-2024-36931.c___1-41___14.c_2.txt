c
   #define MAX_INJECT_SIZE 4096 // Define a reasonable maximum 

   // ... (other code) 

   if (lbuf > MAX_INJECT_SIZE) {
       return -EINVAL; // Or handle the error appropriately
   }
   buffer = vmemdup_user(buf, lbuf); 
   