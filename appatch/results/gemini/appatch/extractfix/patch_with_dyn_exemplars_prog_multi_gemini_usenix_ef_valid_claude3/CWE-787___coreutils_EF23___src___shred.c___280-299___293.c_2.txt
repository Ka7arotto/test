c
static void
fillpattern(int type, unsigned char *r, size_t size) {
  size_t i;

  for (i = 3; i < size / 2; i *= 2) {
    memcpy(r + i, r, MIN(i, size / 2 - i));  // Limit copy size
  }
}
